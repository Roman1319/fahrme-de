# –ë—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –†–µ–∑—é–º–µ

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –®–∞–≥ 1 ‚Äî RLS –¥–ª—è profiles ‚úÖ
- **–°—Ç–∞—Ç—É—Å**: –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- **–ü–æ–ª–∏—Ç–∏–∫–∞**: `"Profiles are viewable by everyone"` —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—Ä–æ—Ñ–∏–ª–∏ –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —á—Ç–µ–Ω–∏—è

### –®–∞–≥ 2 ‚Äî Server Session ‚úÖ
- **–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–ª–∏–µ–Ω—Ç** `createServerSupabaseClient()` –ø–æ –≥–∞–π–¥—É Supabase
- **–û–±–Ω–æ–≤–ª–µ–Ω API —Ä–æ—É—Ç** `/api/cars/route.ts` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
- **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —Å–µ—Å—Å–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** `cookies()` –∏–∑ `next/headers` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 3 ‚Äî Fallback –¥–ª—è Explore ‚úÖ
- **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –≤ `loadFeed()`
- **–î–æ–±–∞–≤–ª–µ–Ω fallback** –Ω–∞ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è
- **–£–±—Ä–∞–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å** –æ—Ç `NODE_ENV` –¥–ª—è fallback
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: `/feed` –Ω–µ –ø–∞–¥–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö RPC

### –®–∞–≥ 4 ‚Äî Smoke-—Ç–µ—Å—Ç ‚úÖ
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ** –≤ dev —Ä–µ–∂–∏–º–µ
- **–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã** –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

## üîß –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –ù–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
```typescript
// src/lib/supabaseServer.ts
export function createServerSupabaseClient() {
  const config = createSupabaseConfig(false);
  const cookieStore = cookies();
  
  return createServerClient(config.url, config.anonKey, {
    cookies: {
      get(name: string) {
        return cookieStore.get(name)?.value;
      },
      // ... –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥–∞–π–¥—É Supabase
    },
  });
}
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π API —Ä–æ—É—Ç
```typescript
// src/app/api/cars/route.ts
const supabase = createSupabaseApiClient(request);
const { data: { user }, error: authError } = await supabase.auth.getUser();
console.log('[Cars API] Auth check:', { 
  hasUser: !!user, 
  userId: user?.id, 
  authError: authError?.message,
  cookies: Object.fromEntries(request.cookies.entries())
});
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```typescript
// src/app/feed/page.tsx
if (error) {
  console.error('[Feed] Error loading feed:', {
    code: error.code,
    message: error.message,
    details: error.details,
    hint: error.hint,
    stack: error.stack
  });
  
  // –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ –≤–º–µ—Å—Ç–æ –ø–∞–¥–µ–Ω–∏—è
  console.log('[Feed] Using fallback data due to error');
  data = [];
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
1. **`/debug/smoke-test`** - –ø–æ–ª–Ω—ã–π smoke-—Ç–µ—Å—Ç
2. **`/debug/quick-test`** - –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç
3. **`/debug/feed`** - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ñ–∏–¥–∞
4. **`/debug/notifications`** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
- ‚úÖ **–ì–æ—Å—Ç—å**: `/explore` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–õ–æ–≥–∏–Ω**: `/feed` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π" –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
- ‚úÖ **Notifications**: —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**: –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –±–µ–∑ 400 –æ—à–∏–±–æ–∫
- ‚úÖ **Server Session**: –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä** –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ `http://localhost:3000`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**:
   - `/` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
   - `/explore` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
   - `/feed` - –ª–µ–Ω—Ç–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π)
   - `/debug/smoke-test` - –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∫—Ä–∞—Å–Ω—ã—Ö –æ—à–∏–±–æ–∫
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab** - –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 400/500 –æ—à–∏–±–æ–∫

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `/debug/feed`
