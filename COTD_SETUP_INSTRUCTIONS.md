# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Å–∏—Å—Ç–µ–º—ã "–ú–∞—à–∏–Ω–∞ –¥–Ω—è" (COTD)

## 1. –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç –≤ Supabase

–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí SQL Editor –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `cotd-setup.sql`:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –¥–ª—è —Å–∏—Å—Ç–µ–º—ã "–ú–∞—à–∏–Ω–∞ –¥–Ω—è" (COTD)
-- –í—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –≤ Supabase SQL Editor

-- 1. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É cotd_days –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–Ω–µ–π –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
CREATE TABLE IF NOT EXISTS cotd_days (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  date DATE NOT NULL UNIQUE,
  status VARCHAR(20) NOT NULL DEFAULT 'voting', -- 'voting', 'closed', 'winner_announced'
  winner_car_id UUID REFERENCES cars(id) ON DELETE SET NULL,
  total_votes INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 2. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É cotd_candidates –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –º–∞—à–∏–Ω—É –¥–Ω—è
CREATE TABLE IF NOT EXISTS cotd_candidates (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  day_id UUID REFERENCES cotd_days(id) ON DELETE CASCADE NOT NULL,
  car_id UUID REFERENCES cars(id) ON DELETE CASCADE NOT NULL,
  votes INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(day_id, car_id)
);

-- 3. –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É cotd_votes –¥–ª—è –≥–æ–ª–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS cotd_votes (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  day_id UUID REFERENCES cotd_days(id) ON DELETE CASCADE NOT NULL,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
  car_id UUID REFERENCES cars(id) ON DELETE CASCADE NOT NULL,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(day_id, user_id) -- –û–¥–∏–Ω –≥–æ–ª–æ—Å –≤ –¥–µ–Ω—å –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
);

-- ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π SQL –∫–æ–¥ –∏–∑ —Ñ–∞–π–ª–∞ cotd-setup.sql)
```

## 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL —Å–∫—Ä–∏–ø—Ç–∞:

1. **–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞**: –î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –±–ª–æ–∫ "–ú–∞—à–∏–Ω–∞ –¥–Ω—è" —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏
2. **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ –º–∞—à–∏–Ω—ã (1 —Ä–∞–∑ –≤ –¥–µ–Ω—å)
3. **–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å**: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ `/admin/cotd` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏

## 3. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:
- **–ë–ª–æ–∫ "–ú–∞—à–∏–Ω–∞ –¥–Ω—è"** –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- **–°–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤** —Å —Ñ–æ—Ç–æ, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏ –∫–Ω–æ–ø–∫–∞–º–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –º–æ–µ–≥–æ –≥–æ–ª–æ—Å–∞** (–≥–∞–ª–æ—á–∫–∞ —É –≤—ã–±—Ä–∞–Ω–Ω–æ–π –º–∞—à–∏–Ω—ã)
- **–ü–ª–∞—à–∫–∞ "–í—á–µ—Ä–∞ –ø–æ–±–µ–¥–∏–ª"** —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≤—á–µ—Ä–∞—à–Ω–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ
- **–°—Ç–∞—Ç—É—Å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è** (–æ—Ç–∫—Ä—ã—Ç–æ/–∑–∞–∫—Ä—ã—Ç–æ)

### ‚úÖ –ê–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏:
- **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤** –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –º–∞—à–∏–Ω
- **–ó–∞–∫—Ä—ã—Ç–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è** –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
- **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏** –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–º** –¥–Ω—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è

### ‚úÖ API Endpoints:
- `GET /api/cotd/today` - –ø–æ–ª—É—á–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å
- `POST /api/cotd/vote` - –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ –º–∞—à–∏–Ω—É
- `POST /api/cotd/admin` - –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤, –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–Ω—è)

## 4. –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Ü–∏–∫–ª:
1. **–£—Ç—Ä–æ–º**: –ê–¥–º–∏–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
2. **–î–µ–Ω—å**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≥–æ–ª–æ—Å—É—é—Ç –∑–∞ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è –º–∞—à–∏–Ω—ã
3. **–í–µ—á–µ—Ä–æ–º**: –ê–¥–º–∏–Ω –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ, —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
4. **–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å**: –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—á–µ—Ä–∞—à–Ω–∏–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—å, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–æ–≤–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- **–û–¥–∏–Ω –≥–æ–ª–æ—Å –≤ –¥–µ–Ω—å** –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ù–µ–ª—å–∑—è –≥–æ–ª–æ—Å–æ–≤–∞—Ç—å** –∑–∞ —Å–≤–æ—é –º–∞—à–∏–Ω—É
- **–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è** —Ç–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–æ–º
- **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω—É—é –æ—à–∏–±–∫—É

## 5. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:
- **`cotd_days`** - –¥–Ω–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è —Å —Å—Ç–∞—Ç—É—Å–æ–º –∏ –ø–æ–±–µ–¥–∏—Ç–µ–ª–µ–º
- **`cotd_candidates`** - –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –Ω–∞ –º–∞—à–∏–Ω—É –¥–Ω—è
- **`cotd_votes`** - –≥–æ–ª–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### RLS –ø–æ–ª–∏—Ç–∏–∫–∏:
- –í—Å–µ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –≥–æ–ª–æ—Å–∞
- –ê–¥–º–∏–Ω—ã –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ –∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –¥–Ω–∏

## 6. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–î–æ–±–∞–≤—å—Ç–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤** —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å `/admin/cotd`
2. **–ü—Ä–æ–≥–æ–ª–æ—Å—É–π—Ç–µ** –∑–∞ –º–∞—à–∏–Ω—É –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ**, —á—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
4. **–ó–∞–∫—Ä–æ–π—Ç–µ –¥–µ–Ω—å** –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
5. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

## 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –¥–Ω–µ–π:
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –¥–µ–Ω—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API.

### –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è:
–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–æ–º —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å.

### –ö–∞–Ω–¥–∏–¥–∞—Ç—ã:
–î–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∞–¥–º–∏–Ω–æ–º –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –º–∞—à–∏–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.

–í—Å–µ –≥–æ—Ç–æ–≤–æ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è! üöóüèÜ
